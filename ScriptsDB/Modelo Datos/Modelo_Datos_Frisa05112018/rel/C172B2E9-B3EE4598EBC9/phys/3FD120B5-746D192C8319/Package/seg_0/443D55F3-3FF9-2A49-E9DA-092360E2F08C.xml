<?xml version = '1.0' encoding = 'UTF-8'?>
<PackageOracle class="oracle.dbtools.crest.model.design.storage.oracle.PackageOracle" name="XXFRP_FECHA" directorySegmentName="seg_0" id="443D55F3-3FF9-2A49-E9DA-092360E2F08C">
<sourceConnName>Frisa_Dev</sourceConnName>
<sourceObjSchema>INGRESOS</sourceObjSchema>
<sourceObjName>XXFRP_FECHA</sourceObjName>
<createdBy>USER_1</createdBy>
<createdTime>2018-11-28 17:36:34 UTC</createdTime>
<ownerDesignName>Modelo_Datos_Frisa05112018</ownerDesignName>
<owner>B49CDF25-C9F3-EDEF-C941-F4C9279E8404</owner>
<source>CREATE OR REPLACE PACKAGE INGRESOS.XXFRP_FECHA AS &lt;br/&gt;&lt;br/&gt;FUNCTION DIAS_HABILES&lt;br/&gt;(fecha_inicio IN DATE, fecha_fin IN DATE)&lt;br/&gt; RETURN NUMBER;&lt;br/&gt; &lt;br/&gt;FUNCTION FECHA_FIN_VIGENCIA&lt;br/&gt;(fecha_inicio IN DATE, plazo IN number)&lt;br/&gt; RETURN date;&lt;br/&gt; &lt;br/&gt;END XXFRP_FECHA;</source>
<body class="oracle.dbtools.crest.model.design.storage.oracle.PackageBodyOracle" name="XXFRP_FECHA" id="443D55F3-3FF9-2A49-E9DA-092360E2F08C">
<sourceConnName>Frisa_Dev</sourceConnName>
<sourceObjSchema>INGRESOS</sourceObjSchema>
<sourceObjName>XXFRP_FECHA</sourceObjName>
<createdBy>USER_1</createdBy>
<createdTime>2018-11-28 17:36:35 UTC</createdTime>
<ownerDesignName>Modelo_Datos_Frisa05112018</ownerDesignName>
<owner>B49CDF25-C9F3-EDEF-C941-F4C9279E8404</owner>
<source>CREATE OR REPLACE PACKAGE BODY INGRESOS.XXFRP_FECHA AS&lt;br/&gt;&lt;br/&gt;FUNCTION DIAS_HABILES&lt;br/&gt;(fecha_inicio IN DATE, fecha_fin IN DATE)&lt;br/&gt; RETURN NUMBER IS&lt;br/&gt;      diasNoHabiles     NUMBER;&lt;br/&gt;      numero_dias NUMBER := 0;&lt;br/&gt;      fecha_actual DATE;&lt;br/&gt;  BEGIN&lt;br/&gt;      --Validar que la información de entrada sea correcta&lt;br/&gt;    /*dbms_output.put_line(&apos;** Valores de entrada **&apos;);&lt;br/&gt;    dbms_output.put_line(&apos;fecha_inicio= &apos; || fecha_inicio);&lt;br/&gt;    dbms_output.put_line(&apos;fecha_fin = &apos; || fecha_fin);*/&lt;br/&gt;      IF fecha_fin &gt;= fecha_inicio THEN    &lt;br/&gt;         fecha_actual := fecha_inicio;&lt;br/&gt;         WHILE fecha_actual &lt;= fecha_fin LOOP&lt;br/&gt;             -- dbms_output.put_line(&apos;TO_CHAR(fecha_actual,DY) = &apos; || TO_CHAR(fecha_actual,&apos;DY&apos;));  &lt;br/&gt;             IF TO_CHAR(fecha_actual,&apos;DY&apos;) NOT IN (&apos;SÁB&apos;,&apos;DOM&apos;)&lt;br/&gt;             THEN numero_dias := numero_dias + 1;&lt;br/&gt;             END IF;&lt;br/&gt;             fecha_actual := fecha_actual + 1;&lt;br/&gt;         END LOOP;&lt;br/&gt;         &lt;br/&gt;         SELECT COUNT (FECHA)&lt;br/&gt;         INTO diasNoHabiles&lt;br/&gt;         FROM XXFXC_DIAS_FESTIVOS&lt;br/&gt;         WHERE FECHA BETWEEN fecha_inicio AND fecha_fin and ind_activo = 1;&lt;br/&gt;         &lt;br/&gt;         RETURN numero_dias - diasNoHabiles;&lt;br/&gt;     ELSE&lt;br/&gt;     	RETURN 0;&lt;br/&gt;     END IF;&lt;br/&gt; END DIAS_HABILES;&lt;br/&gt; &lt;br/&gt; &lt;br/&gt; FUNCTION FECHA_FIN_VIGENCIA&lt;br/&gt;(fecha_inicio IN DATE, plazo IN number)&lt;br/&gt; RETURN date As&lt;br/&gt;  numeroDias Number := 0;&lt;br/&gt;  diferenciaDias Number := 0;&lt;br/&gt;  fechaFinalVigencia Date ;&lt;br/&gt; begin&lt;br/&gt;    /*dbms_output.put_line(&apos;** Valores de entrada **&apos;);&lt;br/&gt;    dbms_output.put_line(&apos;fecha_inicio= &apos; || fecha_inicio);&lt;br/&gt;    dbms_output.put_line(&apos;plazo= &apos; || plazo);&lt;br/&gt;    dbms_output.put_line(&apos;numeroDias= &apos; || numeroDias);*/&lt;br/&gt;  WHILE numeroDias &lt; plazo&lt;br/&gt;    LOOP&lt;br/&gt;    &lt;br/&gt;      &lt;br/&gt;      -- dbms_output.put_line(&apos;diferenciaDias &apos; || diferenciaDias);&lt;br/&gt;       fechaFinalVigencia := fecha_inicio + (diferenciaDias + plazo);&lt;br/&gt;      -- dbms_output.put_line(&apos;fechaFinalVigencia= &apos; || fechaFinalVigencia);&lt;br/&gt;       numeroDias := DIAS_HABILES(fecha_inicio, fechaFinalVigencia);&lt;br/&gt;      -- dbms_output.put_line(&apos;numeroDias= &apos; || numeroDias);&lt;br/&gt;       diferenciaDias := (plazo-numeroDias) + diferenciaDias;&lt;br/&gt;      -- dbms_output.put_line(&apos;diferenciaDias= &apos; || diferenciaDias);&lt;br/&gt;    END LOOP;&lt;br/&gt;  -- dbms_output.put_line(&apos;fechaFinalVigencia= &apos; || fechaFinalVigencia);&lt;br/&gt;  return fechaFinalVigencia;&lt;br/&gt; &lt;br/&gt; end FECHA_FIN_VIGENCIA;&lt;br/&gt;&lt;br/&gt;END XXFRP_FECHA;</source>
</body>
</PackageOracle>